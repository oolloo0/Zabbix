zabbix_export:
  version: '6.4'
  templates:
    - template: "Template AD Events Monitoring"
      groups:
        - name: "Templates/Applications"
      items:
        - name: "New AD User Detected"
          key: "ad.new_user"
          type: 0
          value_type: 3
          delay: "5m"

        - name: "AD Password Change Detected"
          key: "ad.password_change"
          type: 0
          value_type: 3
          delay: "5m"

        - name: "AD Group Membership Change"
          key: "ad.group_membership"
          type: 0
          value_type: 3
          delay: "5m"

      triggers:
        - name: "New User Created in AD"
          expression: "{Template AD Events Monitoring:ad.new_user.last()}=1"
          priority: "Warning"

        - name: "AD Password Changed"
          expression: "{Template AD Events Monitoring:ad.password_change.last()}=1"
          priority: "Information"

        - name: "AD Group Membership Modified"
          expression: "{Template AD Events Monitoring:ad.group_membership.last()}=1"
          priority: "Warning"
